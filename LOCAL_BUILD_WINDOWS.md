# æœ¬åœ° Windows ç¯å¢ƒæ‰“åŒ…æŒ‡å—ï¼ˆä»…ä¾›å‚è€ƒï¼‰

> âš ï¸ **é‡è¦æç¤º**: æœ¬æ–‡æ¡£è®°å½•çš„æ˜¯åœ¨æœ¬åœ° Windows ç¯å¢ƒå°è¯•æ‰“åŒ… APK çš„è¿‡ç¨‹ï¼Œä½†ç”±äºç¯å¢ƒä¾èµ–å¤æ‚ï¼Œå­˜åœ¨è¯¸å¤šé—®é¢˜ã€‚**å¼ºçƒˆå»ºè®®ä½¿ç”¨ GitHub Actions è¿›è¡Œæ‰“åŒ…**ï¼ˆå‚è§ä¸» READMEï¼‰ã€‚

---

## ğŸ¯ å‰ç½®æ¡ä»¶

### å¿…éœ€è½¯ä»¶
1. **Python 3.10+**
2. **uv** (åŒ…ç®¡ç†å·¥å…·)
3. **Flutter SDK**
4. **Android SDK**
5. **Java 17** (JDK)

---

## âš ï¸ å…³é”®é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1: ç”¨æˆ·ååŒ…å«ç©ºæ ¼

**ç—‡çŠ¶**:
```
Flutter æ— æ³•è¯†åˆ«è·¯å¾„ï¼ŒæŠ¥é”™ï¼š'C:\Users\Chen Xinglin\...' ä¸æ˜¯æœ‰æ•ˆè·¯å¾„
```

**è§£å†³æ–¹æ¡ˆ**:
å°†æ‰€æœ‰å¼€å‘å·¥å…·å®‰è£…åœ¨**æ— ç©ºæ ¼è·¯å¾„**ï¼ˆå¦‚ D ç›˜ï¼‰ï¼š
```
D:\flutter\3.38.7\
D:\Android\sdk\
D:\java\17.0.13+11\
```

### é—®é¢˜ 2: Flutter æ— æ³•è¯†åˆ«ç¯å¢ƒå˜é‡

**ç—‡çŠ¶**:
```
Flutter doctor æ‰¾ä¸åˆ° Android SDK
```

**è§£å†³æ–¹æ¡ˆ**:
åœ¨å‘½ä»¤è¡Œä¸­**ä¸´æ—¶è®¾ç½®**ç¯å¢ƒå˜é‡ï¼ˆæ¯æ¬¡æ‰“å¼€æ–° CMD éƒ½éœ€è¦é‡æ–°è®¾ç½®ï¼‰ï¼š

```bash
# è®¾ç½® Flutter è·¯å¾„ï¼ˆæ³¨æ„ç‰ˆæœ¬å·æ–‡ä»¶å¤¹ï¼‰
set PATH=D:\flutter\3.38.7\bin;%PATH%

# è®¾ç½® Java ç¯å¢ƒ
set JAVA_HOME=D:\java\17.0.13+11

# è®¾ç½® Android SDK
set ANDROID_HOME=D:\Android\sdk

# é…ç½® Flutter ä½¿ç”¨æŒ‡å®šçš„ Android SDK
flutter config --android-sdk "D:\Android\sdk"
```

**éªŒè¯é…ç½®**:
```bash
flutter doctor
```

### é—®é¢˜ 3: Android SDK ä¸å®Œæ•´ï¼ˆç»å…¸æ­»é”ï¼‰

**ç—‡çŠ¶**:
- Flet ä¸‹è½½äº† `cmdline-tools`ï¼Œä½†ç¼ºå°‘ `platform-tools`
- Flutter æ£€æŸ¥ SDK æ—¶æŠ¥é”™"æ‰¾ä¸åˆ° SDK"
- å°è¯•ç­¾ç½²åè®®æ—¶æŠ¥é”™"æ‰¾ä¸åˆ° SDK"

**æ­»é”åŸå› **:
1. Flet ä¸‹è½½ SDK æœªå®Œæˆï¼ˆè¢«ä¸­æ–­ï¼‰
2. Flutter è®¤ä¸º SDK ä¸å®Œæ•´ï¼Œæ‹’ç»è¯†åˆ«
3. æ— æ³•ç­¾ç½²åè®®è¡¥æ•‘ï¼Œå› ä¸º Flutter ä¸è®¤è¿™ä¸ª SDK

**è§£å†³æ–¹æ¡ˆ - æ‰‹åŠ¨ä¿®è¡¥ SDK**:

```bash
# ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨å·²ä¸‹è½½çš„ cmdline-tools å®‰è£…ç¼ºå¤±ç»„ä»¶
D:\Android\sdk\cmdline-tools\12.0\bin\sdkmanager.bat "platforms;android-36" "build-tools;28.0.3"

# ç¬¬äºŒæ­¥ï¼šç­¾ç½² Android åè®®
flutter doctor --android-licenses
# å¦‚æœæµç¨‹å¤ªå¿«ï¼Œç›´æ¥å¤šæŒ‰å‡ æ¬¡ y + Enter
```

### é—®é¢˜ 4: åè®®ç­¾ç½²æ»šåŠ¨è¿‡å¿«

**ç—‡çŠ¶**:
åè®®æ–‡æœ¬æ»šåŠ¨æå¿«ï¼Œæ ¹æœ¬æ¥ä¸åŠæŒ‰ `y` åŒæ„

**ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆ 1: ç›´æ¥ç”¨ yes å‘½ä»¤ï¼ˆå¦‚æœæœ‰ï¼‰
yes | flutter doctor --android-licenses

# æ–¹æ¡ˆ 2: ç–¯ç‹‚æ•²å‡» y é”®ï¼ˆä¸æ¨èï¼Œä½†æœ‰æ—¶æœ‰æ•ˆï¼‰
flutter doctor --android-licenses
# ç„¶åç–¯ç‹‚æŒ‰ y + Enter
```

### é—®é¢˜ 5: ç½‘ç»œä»£ç†é—®é¢˜

**ç—‡çŠ¶**:
ä¸‹è½½ Flutter/Android ç»„ä»¶æ—¶è¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
è®¾ç½®ä»£ç†ï¼ˆæ ¹æ®ä½ çš„ä»£ç†å·¥å…·è°ƒæ•´ç«¯å£ï¼‰ï¼š

```bash
# è®¾ç½®ä»£ç†
set http_proxy=http://127.0.0.1:7897
set https_proxy=http://127.0.0.1:7897

# éªŒè¯ä»£ç†æ˜¯å¦ç”Ÿæ•ˆ
curl ifconfig.me
# å¦‚æœè¿”å›éå›½å†… IPï¼Œè¯´æ˜ä»£ç†æˆåŠŸ

# æ¸…é™¤å›½å†…é•œåƒæºï¼ˆé¿å…å†²çªï¼‰
set PIP_INDEX_URL=
set PUB_HOSTED_URL=
set FLUTTER_STORAGE_BASE_URL=
```

---

## ğŸ“¦ æœ¬åœ°æ‰“åŒ…æ­¥éª¤

### 1. ç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥æ‰€æœ‰ä¾èµ–æ˜¯å¦å°±ç»ª
flutter doctor -v

# ç†æƒ³è¾“å‡ºï¼š
# [âœ“] Flutter
# [âœ“] Android toolchain
# [âœ“] Java 17
```

### 2. æ¸…ç†æ—§æ„å»º

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd D:\update_gonggong\GongGong

# åˆ é™¤æ—§æ„å»ºäº§ç‰©
rmdir /s /q build
rmdir /s /q dist
```

### 3. åŒæ­¥ä¾èµ–

```bash
# ä½¿ç”¨ uv å®‰è£…é¡¹ç›®ä¾èµ–
uv sync --reinstall
```

### 4. æ‰§è¡Œæ‰“åŒ…

```bash
# è¯¦ç»†æ¨¡å¼æ‰“åŒ…ï¼ˆæ¨èç”¨äºè°ƒè¯•ï¼‰
uv run flet build apk -vv

# æˆ–ä½¿ç”¨é¡¹ç›®åç§°å‚æ•°
uv run flet build apk --verbose --project "å…¬å…¬çš„ç•™å£°æœº"
```

### 5. æŸ¥æ‰¾ç”Ÿæˆçš„ APK

æ„å»ºæˆåŠŸåï¼ŒAPK æ–‡ä»¶é€šå¸¸ä½äºï¼š
```
build/apk/
```

---

## ğŸ”§ å¸¸è§é”™è¯¯ä¸è§£å†³

### é”™è¯¯ 1: "Flutter SDK not found"

```bash
# é‡æ–°è®¾ç½® PATH
set PATH=D:\flutter\3.38.7\bin;%PATH%
flutter doctor
```

### é”™è¯¯ 2: "No Android SDK found"

```bash
# é‡æ–°é…ç½® SDK è·¯å¾„
set ANDROID_HOME=D:\Android\sdk
flutter config --android-sdk "D:\Android\sdk"
```

### é”™è¯¯ 3: "Java version mismatch"

```bash
# æ£€æŸ¥ Java ç‰ˆæœ¬
java -version
# åº”è¯¥æ˜¾ç¤ºï¼šopenjdk version "17.x.x"

# å¦‚æœä¸æ˜¯ 17ï¼Œé‡æ–°è®¾ç½® JAVA_HOME
set JAVA_HOME=D:\java\17.0.13+11
```

### é”™è¯¯ 4: "License not accepted"

```bash
# é‡æ–°ç­¾ç½²åè®®
flutter doctor --android-licenses
# ç–¯ç‹‚æŒ‰ y
```

### é”™è¯¯ 5: æ„å»ºå¡ä½ä¸åŠ¨

```bash
# æ£€æŸ¥æ˜¯å¦æ˜¯ç½‘ç»œé—®é¢˜
# å¦‚æœä½¿ç”¨ä»£ç†ï¼Œç¡®ä¿ä»£ç†ç¨³å®š

# å¼ºåˆ¶åœæ­¢å¹¶é‡è¯•
Ctrl+C
rmdir /s /q build
uv run flet build apk -vv
```

---

## ğŸ“ å®Œæ•´ç¯å¢ƒå˜é‡è„šæœ¬

ä¸ºäº†æ–¹ä¾¿ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ‰¹å¤„ç†è„šæœ¬ `setup_env.bat`ï¼š

```batch
@echo off
echo æ­£åœ¨é…ç½®å¼€å‘ç¯å¢ƒå˜é‡...

REM Flutter
set PATH=D:\flutter\3.38.7\bin;%PATH%

REM Java
set JAVA_HOME=D:\java\17.0.13+11
set PATH=%JAVA_HOME%\bin;%PATH%

REM Android SDK
set ANDROID_HOME=D:\Android\sdk
set PATH=%ANDROID_HOME%\cmdline-tools\12.0\bin;%PATH%
set PATH=%ANDROID_HOME%\platform-tools;%PATH%

REM ä»£ç†ï¼ˆå¯é€‰ï¼Œæ ¹æ®éœ€è¦å–æ¶ˆæ³¨é‡Šï¼‰
REM set http_proxy=http://127.0.0.1:7897
REM set https_proxy=http://127.0.0.1:7897

REM æ¸…é™¤å›½å†…é•œåƒ
set PIP_INDEX_URL=
set PUB_HOSTED_URL=
set FLUTTER_STORAGE_BASE_URL=

echo ç¯å¢ƒé…ç½®å®Œæˆï¼
echo.
echo éªŒè¯ç¯å¢ƒ...
flutter doctor -v

pause
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
# æ¯æ¬¡æ‰“å¼€æ–°çš„ CMD çª—å£æ—¶è¿è¡Œ
setup_env.bat
```

---

## ğŸš€ æœ€ä½³å®è·µå»ºè®®

### âœ… æ¨èåšæ³•

1. **ä½¿ç”¨ GitHub Actions**
   - æ— éœ€é…ç½®æœ¬åœ°ç¯å¢ƒ
   - æ„å»ºç¯å¢ƒä¸€è‡´æ€§æœ‰ä¿éšœ
   - è‡ªåŠ¨åŒ–æµç¨‹ï¼Œå¯é‡ç°

2. **å¦‚æœå¿…é¡»æœ¬åœ°æ„å»º**ï¼š
   - æ‰€æœ‰å·¥å…·å®‰è£…åœ¨æ— ç©ºæ ¼è·¯å¾„
   - ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ç®¡ç†ç¯å¢ƒå˜é‡
   - ä¿æŒç½‘ç»œç¨³å®šï¼ˆæˆ–é…ç½®å¯é ä»£ç†ï¼‰

### âŒ é¿å…çš„åšæ³•

- âŒ å°†å·¥å…·å®‰è£…åœ¨ `C:\Users\ç”¨æˆ·å\` ä¸‹ï¼ˆå¦‚æœç”¨æˆ·åæœ‰ç©ºæ ¼ï¼‰
- âŒ ä¾èµ–ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼ˆå®¹æ˜“å†²çªï¼‰
- âŒ åœ¨ç½‘ç»œä¸ç¨³å®šæ—¶å¼ºè¡Œæ„å»º
- âŒ æ··ç”¨å¤šä¸ªç‰ˆæœ¬çš„ Flutter/Java

---

## ğŸ†š æœ¬åœ° vs GitHub Actions å¯¹æ¯”

| å¯¹æ¯”é¡¹ | æœ¬åœ° Windows | GitHub Actions |
|--------|--------------|----------------|
| **ç¯å¢ƒé…ç½®** | âŒ å¤æ‚ï¼Œæ˜“å‡ºé”™ | âœ… è‡ªåŠ¨é…ç½® |
| **ä¾èµ–ç®¡ç†** | âŒ æ‰‹åŠ¨å®‰è£… | âœ… è‡ªåŠ¨å®‰è£… |
| **æ„å»ºé€Ÿåº¦** | âš ï¸ å–å†³äºç”µè„‘æ€§èƒ½ | âœ… äº‘æœåŠ¡å™¨ï¼Œç¨³å®š |
| **å¯é‡ç°æ€§** | âŒ ç¯å¢ƒå·®å¼‚å¤§ | âœ… ç¯å¢ƒä¸€è‡´ |
| **ç½‘ç»œè¦æ±‚** | âŒ éœ€è¦ç¨³å®šä»£ç† | âœ… æœåŠ¡å™¨ç›´è¿ |
| **åè®®ç­¾ç½²** | âŒ æ‰‹åŠ¨ï¼Œæ˜“å‡ºé”™ | âœ… è‡ªåŠ¨åŒ– |
| **è°ƒè¯•éš¾åº¦** | âš ï¸ ä¸­ç­‰ | âœ… æ—¥å¿—å®Œæ•´ |

**ç»“è®º**: é™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼ˆå¦‚ç¦»çº¿å¼€å‘ï¼‰ï¼Œå¦åˆ™å¼ºçƒˆå»ºè®®ä½¿ç”¨ GitHub Actionsã€‚

---

## ğŸ“ æ•…éšœæ’æŸ¥æ¸…å•

å¦‚æœæœ¬åœ°æ‰“åŒ…ä»ç„¶å¤±è´¥ï¼Œè¯·æŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥ï¼š

- [ ] æ‰€æœ‰å·¥å…·è·¯å¾„ä¸åŒ…å«ç©ºæ ¼æˆ–ä¸­æ–‡
- [ ] `flutter doctor` æ‰€æœ‰é¡¹éƒ½é€šè¿‡ï¼ˆâœ“ï¼‰
- [ ] `java -version` æ˜¾ç¤º 17.x
- [ ] `echo %ANDROID_HOME%` æŒ‡å‘æ­£ç¡®è·¯å¾„
- [ ] Android åè®®å·²å…¨éƒ¨ç­¾ç½²
- [ ] ç½‘ç»œè¿æ¥ç¨³å®šï¼ˆæˆ–ä»£ç†æ­£å¸¸ï¼‰
- [ ] æ¸…ç©ºäº† `build/` ç›®å½•
- [ ] ä½¿ç”¨ `uv sync --reinstall` é‡æ–°å®‰è£…ä¾èµ–

å¦‚æœä»¥ä¸Šéƒ½æ­£å¸¸ï¼Œä½†ä»ç„¶å¤±è´¥ï¼Œå»ºè®®ï¼š
1. æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿— (`-vv` å‚æ•°)
2. åˆ‡æ¢åˆ° GitHub Actions æ‰“åŒ…
3. åœ¨ GitHub Issues å¯»æ±‚å¸®åŠ©ï¼Œé™„ä¸Šå®Œæ•´æ—¥å¿—

---

## ğŸ”— ç›¸å…³èµ„æº

- [Flutter å®˜æ–¹ Windows å®‰è£…æŒ‡å—](https://docs.flutter.dev/get-started/install/windows)
- [Android Studio ä¸‹è½½](https://developer.android.com/studio)
- [Flet æ‰“åŒ…æ–‡æ¡£](https://docs.flet.dev/publish/android/)
- [Java 17 ä¸‹è½½](https://adoptium.net/)
- [å¤§ç¥çš„åˆ†æï¼šå¯èƒ½æœ¬åœ°æ‰“åŒ…ç¡®å®åˆéš¾ä»¥ä¿®å¤çš„bug](https://github.com/flet-dev/flet/issues/5507)
---

**æœ€åæé†’**: æœ¬åœ°æ‰“åŒ…æ˜¯ä¸€æ¡å……æ»¡åå·çš„é“è·¯ï¼Œå¦‚æœä½ åœ¨æ„æ—¶é—´æˆæœ¬ï¼Œè¯·ç›´æ¥ä½¿ç”¨ GitHub Actions ğŸš€
