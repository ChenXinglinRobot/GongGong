# å…¬å…¬çš„ç•™å£°æœº (GongGong)

> ä¸ºé˜¿å°”èŒ¨æµ·é»˜ç—‡æ‚£è€…å®šåˆ¶çš„äº’åŠ¨å¼å›å¿†ç–—æ³•åº”ç”¨

## ğŸ“Œ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€æ¬¾åŸºäº Flet æ¡†æ¶å¼€å‘çš„æœ¬åœ°åŒ– Python åº”ç”¨ï¼Œé€šè¿‡è§†é¢‘äº’åŠ¨çš„æ–¹å¼ä¸ºé˜¿å°”èŒ¨æµ·é»˜ç—‡æ‚£è€…æä¾›å›å¿†ç–—æ³•ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è¯é¢˜é€‰æ‹©æœºåˆ¶ï¼Œæ¯ä¸ªè¯é¢˜åŒ…å«å¤šä¸ªé—®é¢˜ï¼Œæ¯ä¸ªé—®é¢˜é€šè¿‡ 4 ä¸ªé˜¶æ®µçš„è§†é¢‘è¿›è¡Œäº¤äº’å¼å¼•å¯¼ï¼ˆæé—® â†’ é‡å¤ â†’ åé¦ˆ â†’ å¼•å¯¼ï¼‰ã€‚

**å½“å‰çŠ¶æ€**:
- âœ… æ¡Œé¢ç«¯å®Œå…¨æ­£å¸¸
- âœ… Android APK æˆåŠŸæ‰“åŒ…ï¼ˆé€šè¿‡ GitHub Actionsï¼‰
- âš ï¸ å·²çŸ¥é—®é¢˜ï¼šè§†é¢‘æ’­æ”¾é»‘å±ï¼ˆå·²åˆ›å»º `fix/video-black-screen` åˆ†æ”¯è§£å†³ä¸­ï¼‰

---

## ğŸ›  æŠ€æœ¯æ ˆ

### æ ¸å¿ƒä¾èµ–
- **Python**: 3.10+
- **GUI æ¡†æ¶**: Flet 0.80.5+ï¼ˆåŸºäº 2026 å¹´æœ€æ–°ç‰ˆæœ¬ï¼‰
- **è§†é¢‘ç»„ä»¶**: flet-video 0.80.5+
- **åŒ…ç®¡ç†**: uvï¼ˆæ¨èï¼‰

### å…³é”®è¯­æ³•è§„èŒƒï¼ˆåŸºäº Flet 0.80+ï¼‰

> âš ï¸ Flet æ›´æ–°æå¿«ï¼Œä»¥ä¸‹è§„èŒƒåŸºäº 2026 å¹´æœ€æ–°ç‰ˆæœ¬ï¼Œå¦‚æœ‰ç–‘é—®è¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£

| ç±»åˆ« | è§„èŒƒ | ç¤ºä¾‹ |
|------|------|------|
| **å…¥å£ç‚¹** | `ft.run(main, assets_dir="assets")` | ä» `src/` ä¸Šä¸‹æ–‡æ‰§è¡Œ |
| **å¯¼èˆª** | å¿…é¡»ä½¿ç”¨ `await page.push_route(route)` | å¼‚æ­¥å‡½æ•°å†…ä½¿ç”¨ï¼Œå¿…é¡» await |
| **æŒ‰é’®æ–‡æœ¬** | `ft.FilledButton(content=ft.Text("..."))` | âŒ æ—  `text` å‚æ•° |
| **å›¾æ ‡** | `ft.Icons.XXX`ï¼ˆå¤§å†™ï¼‰ | `ft.Icons.PLAY_CIRCLE` |
| **é¢œè‰²** | `ft.Colors.XXX`ï¼ˆå¤§å†™ï¼‰æˆ–åå…­è¿›åˆ¶ | `ft.Colors.BLUE_400` æˆ– `"#0000FF"` |
| **å¯¹é½** | `ft.Alignment(x, y)` | `ft.Alignment(0, 0)` è¡¨ç¤ºå±…ä¸­ |
| **åœ†è§’** | `ft.BorderRadius.all(value)` | `ft.BorderRadius.all(10)` |
| **äº‹ä»¶å¤„ç†** | æ‰€æœ‰ handler å¿…é¡»æ˜¯ `async def` | âŒ ä¸æ”¯æŒ lambda |

### è§†é¢‘å¼ºåˆ¶é‡æ¸²æŸ“ç­–ç•¥

ä¸ºè§£å†³ Android/Web ç«¯è§†é¢‘ç¼“å­˜/å†»ç»“é—®é¢˜ï¼Œé‡‡ç”¨**"å®¹å™¨æ›¿æ¢"**æ¨¡å¼ï¼š
- âŒ ä¸æ›´æ–°ç°æœ‰æ’­æ”¾å™¨çš„ playlist
- âœ… æ¯æ¬¡åˆ‡æ¢è§†é¢‘æ—¶åˆ›å»ºå…¨æ–°çš„ `ftv.Video` å®ä¾‹
- âœ… æ›¿æ¢ `Container.content` å¼ºåˆ¶è§†é¢‘å¼•æ“å®Œå…¨é‡ç½®

```python
# ç¤ºä¾‹ä»£ç ç‰‡æ®µ
new_player = ftv.Video(
    expand=True,
    autoplay=True,
    playlist=[ftv.VideoMedia(src)],
    key=f"video_{unique_id}"  # ç¡®ä¿å”¯ä¸€æ€§
)
video_container.content = new_player
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
GongGong/
â”‚
â”œâ”€â”€ .github/workflows/          # CI/CD è‡ªåŠ¨åŒ–
â”‚   â””â”€â”€ build_apk.yml           # GitHub Actions æ‰“åŒ…é…ç½®
â”‚
â”œâ”€â”€ src/                        # æºä»£ç æ ¹ç›®å½•
â”‚   â”œâ”€â”€ main.py                 # åº”ç”¨å…¥å£ï¼šç”Ÿå‘½å‘¨æœŸ & è·¯ç”±é€»è¾‘
â”‚   â”œâ”€â”€ views.py                # UI å±‚ï¼šèœå•è§†å›¾ã€æ’­æ”¾å™¨è§†å›¾
â”‚   â”œâ”€â”€ data_loader.py          # æ•°æ®å±‚ï¼šæ‰«æ assets å¹¶æ„å»º Topic å¯¹è±¡
â”‚   â”œâ”€â”€ create_files.py         # å·¥å…·è„šæœ¬
â”‚   â”‚
â”‚   â””â”€â”€ assets/                 # åª’ä½“èµ„æºç›®å½•ï¼ˆè‡ªåŠ¨æ‰«æï¼‰
â”‚       â”œâ”€â”€ icon.png            # åº”ç”¨å›¾æ ‡
â”‚       â”œâ”€â”€ splash_android.png  # å¯åŠ¨å±å¹•
â”‚       â”‚
â”‚       â”œâ”€â”€ topic_naming/       # [è¯é¢˜æ–‡ä»¶å¤¹ç¤ºä¾‹ï¼šèµ·åå­—]
â”‚       â”‚   â”œâ”€â”€ q1_0_ask_name.mp4     # Q1: åˆå§‹æé—®ï¼ˆState 0ï¼‰
â”‚       â”‚   â”œâ”€â”€ q1_1_repeat_name.mp4  # Q1: æ¸©å’Œé‡å¤ï¼ˆState 1ï¼‰
â”‚       â”‚   â”œâ”€â”€ q1_2_praise_name.mp4  # Q1: æ­£å‘åé¦ˆï¼ˆState 2ï¼‰
â”‚       â”‚   â””â”€â”€ q1_3_guide_name.mp4   # Q1: å¼•å¯¼/å®‰æ…°ï¼ˆState 3ï¼‰
â”‚       â”‚
â”‚       â””â”€â”€ topic_huize/        # [è¯é¢˜æ–‡ä»¶å¤¹ç¤ºä¾‹ï¼šæƒ æ³½å°åƒ]
â”‚           â””â”€â”€ ... (åŒä¸Šç»“æ„)
â”‚
â”œâ”€â”€ pyproject.toml              # æ ¸å¿ƒé…ç½®ï¼šä¾èµ–ã€æ„å»ºå‚æ•°ã€æƒé™
â”œâ”€â”€ uv.lock                     # ä¾èµ–é”å®šæ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥è§„åˆ™
â””â”€â”€ README.md                   # æœ¬æ–‡æ¡£
```

---

## ğŸ¯ å‘½åè§„èŒƒä¸æ•°æ®æ¨¡å‹

### è§†é¢‘æ–‡ä»¶å‘½åè§„åˆ™

**æ ¼å¼**: `q{sequence_id}_{type_id}_{description}.mp4`

**å‚æ•°è¯´æ˜**:
- `sequence_id`: æ•´æ•°ï¼ˆ1, 2, 3...ï¼‰ï¼Œå†³å®šé—®é¢˜åœ¨è¯é¢˜ä¸­çš„é¡ºåº
- `type_id`: æ•´æ•°ï¼ˆ0-3ï¼‰ï¼Œå†³å®šè§†é¢‘è§’è‰²ï¼š
  - `0` â†’ **Query** (åˆå§‹æé—®)
  - `1` â†’ **Repeat** (è‡ªç„¶é‡å¤)
  - `2` â†’ **Correct** (æ­£ç¡®åé¦ˆ)
  - `3` â†’ **Guide** (å¼•å¯¼/å®‰æ…°)
- `description`: å­—ç¬¦ä¸²ï¼ˆå¯é€‰ï¼Œä¾¿äºäººç±»è¯†åˆ«ï¼Œå¦‚ "ask_name"ï¼‰

**ç¤ºä¾‹**:
```
q1_0_ask_name.mp4      # ç¬¬1é¢˜çš„åˆå§‹æé—®
q1_1_repeat_name.mp4   # ç¬¬1é¢˜çš„é‡å¤
q2_0_ask_snack.mp4     # ç¬¬2é¢˜çš„åˆå§‹æé—®
```

### æ•°æ®ç»“æ„

```python
@dataclass
class Question:
    id: int                    # å¯¹åº” sequence_id
    videos: Dict[int, str]     # {type_id: æ–‡ä»¶è·¯å¾„}
    
    def is_valid(self) -> bool:
        """éªŒè¯æ˜¯å¦åŒ…å«å®Œæ•´çš„ 4 ä¸ªé˜¶æ®µè§†é¢‘"""
        return all(k in self.videos for k in [0, 1, 2, 3])

@dataclass
class Topic:
    id: str                    # æ–‡ä»¶å¤¹åï¼ˆå¦‚ "topic_naming"ï¼‰
    name: str                  # æ˜¾ç¤ºåç§°ï¼ˆå¦‚ "èµ·åå­—"ï¼‰
    questions: List[Question]  # æŒ‰ id æ’åºçš„é—®é¢˜åˆ—è¡¨
```

---

## ğŸ® äº¤äº’é€»è¾‘ï¼ˆçŠ¶æ€æœºï¼‰

æ’­æ”¾å™¨è§†å›¾é’ˆå¯¹æ¯ä¸ª `Question` å¯¹è±¡ç®¡ç† 4 ä¸ªçŠ¶æ€ï¼ˆå¯¹åº” `type_id`ï¼‰ï¼š

### State 0: Queryï¼ˆæé—®ï¼‰
- **åŠ¨ä½œ**: è‡ªåŠ¨æ’­æ”¾ `Video[0]`ï¼ˆåˆå§‹æé—®ï¼‰
- **ç”¨æˆ·æ“ä½œ**:
  - ğŸ”µ **å¬ä¸æ¸…/å†è¯´ä¸€é** â†’ è½¬åˆ° State 1
  - ğŸŸ¢ **å›ç­”æ­£ç¡®** â†’ è½¬åˆ° State 2
  - ğŸŸ  **å¿˜è®°äº†** â†’ è½¬åˆ° State 3

### State 1: Repeatï¼ˆé‡å¤ï¼‰
- **åŠ¨ä½œ**: æ’­æ”¾ `Video[1]`ï¼ˆæ¸©å’Œé‡å¤ï¼‰
- **ç”¨æˆ·æ“ä½œ**: åŒ State 0ï¼ˆå¯ç»§ç»­å›ç­”æˆ–å†æ¬¡è¯·æ±‚é‡å¤ï¼‰

### State 2: Correctï¼ˆæ­£ç¡®åé¦ˆï¼‰
- **åŠ¨ä½œ**: æ’­æ”¾ `Video[2]`ï¼ˆæ­£å‘é¼“åŠ±ï¼‰
- **ç”¨æˆ·æ“ä½œ**:
  - ğŸŸ¢ **ä¸‹ä¸€é¢˜** â†’ åŠ è½½ä¸‹ä¸€ä¸ª Questionï¼ˆè¿”å› State 0ï¼‰
  - ğŸ  **è¿”å›èœå•**ï¼ˆå¦‚æœæ˜¯æœ€åä¸€é¢˜ï¼‰

### State 3: Guideï¼ˆå¼•å¯¼ï¼‰
- **åŠ¨ä½œ**: æ’­æ”¾ `Video[3]`ï¼ˆå¼•å¯¼/å®‰æ…°ï¼‰
- **ç”¨æˆ·æ“ä½œ**:
  - ğŸ”„ **é‡è¯•** â†’ é‡æ–°åŠ è½½å½“å‰ Questionï¼ˆè¿”å› State 0ï¼‰
  - â­ï¸ **è·³è¿‡** â†’ åŠ è½½ä¸‹ä¸€ä¸ª Questionï¼ˆè¿”å› State 0ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ¬åœ°è¿è¡Œ

#### 1. å®‰è£…ä¾èµ–ï¼ˆæ¨èä½¿ç”¨ uvï¼‰

```bash
# å®‰è£… uvï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
pip install uv

# åŒæ­¥ä¾èµ–
uv sync
```

#### 2. æ¡Œé¢æ¨¡å¼è¿è¡Œ

```bash
uv run flet run
```

#### 3. Web æ¨¡å¼è¿è¡Œ

```bash
uv run flet run --web
```

---

## ğŸ“¦ Android APK æ‰“åŒ…

### æ–¹å¼ä¸€ï¼šGitHub Actions è‡ªåŠ¨æ‰“åŒ…ï¼ˆâœ… æ¨èï¼‰

**æµç¨‹è¯´æ˜**:
1. æ¨é€ä»£ç åˆ° `main` æˆ– `master` åˆ†æ”¯
2. GitHub Actions è‡ªåŠ¨è§¦å‘æ„å»ºæµç¨‹ï¼ˆè§ `.github/workflows/build_apk.yml`ï¼‰
3. æ„å»ºå®Œæˆååœ¨ **Actions** é¡µé¢ä¸‹è½½ APK

**æ‰‹åŠ¨è§¦å‘**:
- è¿›å…¥ GitHub ä»“åº“ â†’ Actions â†’ "Build Android APK" â†’ Run workflow

**é…ç½®è¯´æ˜**:
- è¿è¡Œç¯å¢ƒ: `ubuntu-latest`ï¼ˆLinuxï¼‰
- Java: Temurin 17
- Flutter: Stable é€šé“
- ä¾èµ–ç®¡ç†: uv
- æ„å»ºå‘½ä»¤: `uv run flet build apk --verbose --project "Gonggong"`

**å…³é”®ä¼˜åŠ¿**:
- âœ… æ— éœ€æœ¬åœ°é…ç½® Flutter/Android SDK
- âœ… ç¯å¢ƒä¸€è‡´æ€§æœ‰ä¿éšœ
- âœ… è‡ªåŠ¨åŒ–æ„å»ºï¼Œå¯å¤ç°

### æ–¹å¼äºŒï¼šæœ¬åœ°æ‰“åŒ…ï¼ˆä»…é™å‚è€ƒï¼‰

> âš ï¸ æœ¬åœ° Windows ç¯å¢ƒæ‰“åŒ…å­˜åœ¨è¯¸å¤šç¯å¢ƒä¾èµ–é—®é¢˜ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨ GitHub Actions

**è¯¦ç»†çš„æœ¬åœ°æ‰“åŒ…å°è¯•è®°å½•** è¯·å‚è€ƒï¼š[`LOCAL_BUILD_WINDOWS.md`](./LOCAL_BUILD_WINDOWS.md)

**ç®€è¦æ­¥éª¤**:
```bash
# ç¡®ä¿å·²å®‰è£… Flutterã€Android SDKã€Java 17
# æ¸…ç†æ—§æ„å»º
uv run flet build apk -vv
```

**å¸¸è§é—®é¢˜**:
- ç”¨æˆ·ååŒ…å«ç©ºæ ¼å¯¼è‡´ Flutter æ— æ³•è¯†åˆ«
- åè®®ç­¾ç½²æµç¨‹è¿‡å¿«
- ç¯å¢ƒå˜é‡é…ç½®å¤æ‚

---

## âš™ï¸ é…ç½®æ–‡ä»¶è¯´æ˜

### pyproject.toml

æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ŒåŒ…å«é¡¹ç›®å…ƒä¿¡æ¯ã€ä¾èµ–å’Œæ„å»ºå‚æ•°ã€‚

```toml
[tool.flet]
org = "com.gonggong"            # ç»„ç»‡æ ‡è¯†ç¬¦
product = "å…¬å…¬çš„ç•™å£°æœº"         # åº”ç”¨åç§°
company = "GongGong Family"     # å…¬å¸/å›¢é˜Ÿå

[tool.flet.app]
path = "src"                    # æºç è·¯å¾„

[tool.flet.android]
split_per_abi = false           # false = é€šç”¨åŒ…ï¼Œtrue = æŒ‰æ¶æ„åˆ†åŒ…

[tool.flet.android.permission]
"android.permission.INTERNET" = true
"android.permission.READ_EXTERNAL_STORAGE" = true
```

---

## âš ï¸ å·²çŸ¥é—®é¢˜

### è§†é¢‘æ’­æ”¾é»‘å±

**é—®é¢˜æè¿°**:
- æ¡Œé¢ç«¯ä½¿ç”¨ `ft.AppView.WEB_BROWSER` æ¨¡å¼æ—¶è§†é¢‘æ­£å¸¸
- æ¡Œé¢å®¢æˆ·ç«¯æ¨¡å¼å’Œ Android åº”ç”¨ä¸­è§†é¢‘æ˜¾ç¤ºé»‘å±
- å…¶ä»–åŠŸèƒ½å®Œå…¨æ­£å¸¸

**å½“å‰çŠ¶æ€**:
- å·²åˆ›å»º `fix/video-black-screen` åˆ†æ”¯ä¸“é—¨è§£å†³æ­¤é—®é¢˜
- åˆæ­¥åˆ†æä¸è§†é¢‘ç¼–è§£ç å™¨/ç¡¬ä»¶åŠ é€Ÿæœ‰å…³

**ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**:
```python
# åœ¨å¼€å‘è°ƒè¯•æ—¶å¯ä½¿ç”¨ Web æ¨¡å¼
ft.run(main, assets_dir="assets", view=ft.AppView.WEB_BROWSER)
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Flet å®˜æ–¹æ–‡æ¡£](https://docs.flet.dev/)
- [Android æ‰“åŒ…æŒ‡å—](https://docs.flet.dev/publish/android/)
- [flet-video ç»„ä»¶æ–‡æ¡£](https://flet.dev/docs/controls/video)

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'æ·»åŠ æŸæŸåŠŸèƒ½'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

**æ³¨æ„äº‹é¡¹**:
- æ‰€æœ‰å‡½æ•°å¿…é¡»æ·»åŠ ä¸­æ–‡æ³¨é‡Š
- éµå¾ª Flet 0.80+ çš„æœ€æ–°è¯­æ³•è§„èŒƒ
- æµ‹è¯•ä»£ç åœ¨æ¡Œé¢å’Œ Web æ¨¡å¼ä¸‹çš„å…¼å®¹æ€§

---

## ğŸ“„ è®¸å¯è¯

Copyright (C) 2026 GongGong Family

---

## ğŸ‘¤ ä½œè€…

GongGong Developer  
é‚®ç®±: 1641782731@qq.com
